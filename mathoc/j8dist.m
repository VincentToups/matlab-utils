function dist=j8dist(section, location)
% D=J8DIST(SECTION, LOCATION) returns the distance D in the j8 physio
% in section SECTION at location (between 0 1) LOCATION

soma.L = 13.2372; soma.diam = 29.7838;
a1_1.L = 6.05687; a1_1.diam = 3;
a1_11.L = 11.5067; a1_11.diam = 2;
a1_111.L = 14.2194; a1_111.diam = 1.21429;
a1_1111.L = 148.421; a1_1111.diam = 0.543103;
a1_1112.L = 154.154; a1_1112.diam = 0.490741;
a1_112.L = 14.259; a1_112.diam = 1.05;
a1_1121.L = 132.288; a1_1121.diam = 0.548837;
a1_1122.L = 157.897; a1_1122.diam = 0.554386;
a1_12.L = 12.8136; a1_12.diam = 2.26;
a1_121.L = 37.476; a1_121.diam = 1;
a1_1211.L = 146.932; a1_1211.diam = 0.661224;
a1_1212.L = 121.249; a1_1212.diam = 0.651923;
a1_122.L = 11.518; a1_122.diam = 1.2;
a1_1221.L = 143.02; a1_1221.diam = 0.546939;
a1_1222.L = 29.3049; a1_1222.diam = 0.646154;
a1_12221.L = 130.01; a1_12221.diam = 0.462745;
a1_12222.L = 120.775; a1_12222.diam = 0.569388;
a2_1.L = 17.2637; a2_1.diam = 2.82857;
a2_11.L = 16.7014; a2_11.diam = 1.5875;
a2_111.L = 24.1102; a2_111.diam = 1.17;
a2_1111.L = 122.868; a2_1111.diam = 0.608889;
a2_1112.L = 216.938; a2_1112.diam = 0.804938;
a2_112.L = 32.0274; a2_112.diam = 0.88125;
a2_1121.L = 110.054; a2_1121.diam = 0.531707;
a2_1122.L = 129.363; a2_1122.diam = 0.631481;
a2_12.L = 40.2854; a2_12.diam = 2.51538;
a2_121.L = 27.7967; a2_121.diam = 2.4;
a2_1211.L = 34.0043; a2_1211.diam = 1.4;
a2_12111.L = 123.161; a2_12111.diam = 0.925;
a2_121111.L = 140.35; a2_121111.diam = 0.623077;
a2_121112.L = 96.4734; a2_121112.diam = 0.541935;
a2_12112.L = 11.6505; a2_12112.diam = 1.2;
a2_121121.L = 128.101; a2_121121.diam = 1.255;
a2_1211211.L = 77.6483; a2_1211211.diam = 0.466667;
a2_1211212.L = 43.7828; a2_1211212.diam = 0.91;
a2_12112121.L = 90.1196; a2_12112121.diam = 0.586957;
a2_12112122.L = 148.224; a2_12112122.diam = 0.569565;
a2_121122.L = 95.5292; a2_121122.diam = 0.541463;
a2_1212.L = 141.495; a2_1212.diam = 1.18378;
a2_12121.L = 13.5859; a2_12121.diam = 1.08;
a2_121211.L = 131.848; a2_121211.diam = 0.5;
a2_121212.L = 113.783; a2_121212.diam = 0.46875;
a2_12122.L = 116.346; a2_12122.diam = 0.389744;
a2_122.L = 30.6701; a2_122.diam = 1.52222;
a2_1221.L = 52.0944; a2_1221.diam = 0.894444;
a2_12211.L = 45.5794; a2_12211.diam = 0.43125;
a2_12212.L = 61.9784; a2_12212.diam = 0.419048;
a2_1222.L = 149.751; a2_1222.diam = 1.1;
a2_12221.L = 87.2862; a2_12221.diam = 0.404545;
a2_12222.L = 131.006; a2_12222.diam = 0.483333;
a3_1.L = 15.82; a3_1.diam = 3.21667;
a3_11.L = 43.2933; a3_11.diam = 1.42143;
a3_111.L = 48.7709; a3_111.diam = 1.57333;
a3_1111.L = 184.401; a3_1111.diam = 0.838571;
a3_1112.L = 81.1897; a3_1112.diam = 1.00714;
a3_11121.L = 115.701; a3_11121.diam = 0.655;
a3_11122.L = 105.537; a3_11122.diam = 0.594737;
a3_112.L = 9.28017; a3_112.diam = 1.36;
a3_1121.L = 129.549; a3_1121.diam = 0.674;
a3_1122.L = 151.072; a3_1122.diam = 0.505882;
a3_12.L = 12.2019; a3_12.diam = 2.82;
a3_121.L = 11.2544; a3_121.diam = 2.71667;
a3_1211.L = 153.142; a3_1211.diam = 0.542857;
a3_1212.L = 28.104; a3_1212.diam = 2.16364;
a3_12121.L = 125.801; a3_12121.diam = 0.561364;
a3_12122.L = 8.79107; a3_12122.diam = 2.2;
a3_121221.L = 134.764; a3_121221.diam = 0.479661;
a3_121222.L = 46.5842; a3_121222.diam = 1.4087;
a3_1212221.L = 95.4744; a3_1212221.diam = 0.526829;
a3_1212222.L = 47.9439; a3_1212222.diam = 1.4;
a3_12122221.L = 231.936; a3_12122221.diam = 0.752703;
a3_12122222.L = 56.965; a3_12122222.diam = 1.24167;
a3_121222221.L = 52.1654; a3_121222221.diam = 0.718182;
a3_1212222211.L = 25.0106; a3_1212222211.diam = 0.554545;
a3_12122222111.L = 16.5769; a3_12122222111.diam = 0.433333;
a3_12122222112.L = 60.6739; a3_12122222112.diam = 0.555556;
a3_1212222212.L = 70.3359; a3_1212222212.diam = 0.411111;
a3_121222222.L = 93.104; a3_121222222.diam = 0.859375;
a3_1212222221.L = 66.217; a3_1212222221.diam = 0.405556;
a3_1212222222.L = 99.1127; a3_1212222222.diam = 0.54;
a3_12122222221.L = 14.6566; a3_12122222221.diam = 0.5;
a3_12122222222.L = 16.4214; a3_12122222222.diam = 0.4;
a3_122.L = 17.0448; a3_122.diam = 1.18333;
a3_1221.L = 41.0837; a3_1221.diam = 0.823529;
a3_12211.L = 81.7397; a3_12211.diam = 0.548485;
a3_12212.L = 96.4826; a3_12212.diam = 0.5;
a3_1222.L = 183.708; a3_1222.diam = 0.750794;
a4_1.L = 18.7453; a4_1.diam = 1.5;
a4_11.L = 5.81576; a4_11.diam = 1;
a4_111.L = 20.8294; a4_111.diam = 1.14444;
a4_1111.L = 128.953; a4_1111.diam = 0.536842;
a4_1112.L = 8.89005; a4_1112.diam = 1.1;
a4_11121.L = 130.933; a4_11121.diam = 0.569811;
a4_11122.L = 116.768; a4_11122.diam = 0.575;
a4_112.L = 31.6166; a4_112.diam = 0.9875;
a4_1121.L = 137.559; a4_1121.diam = 0.550877;
a4_1122.L = 159.206; a4_1122.diam = 0.420635;
a4_12.L = 25.1858; a4_12.diam = 1.1;
a4_121.L = 190.305; a4_121.diam = 0.563492;
a4_122.L = 10.4333; a4_122.diam = 1.64;
a4_1221.L = 42.5039; a4_1221.diam = 0.713333;
a4_1222.L = 6.60089; a4_1222.diam = 1.06;
a4_12221.L = 116.537; a4_12221.diam = 0.583721;
a4_12222.L = 121.106; a4_12222.diam = 0.588095;

dist = 0;
while '_' ~= section(end)
  dist = dist + eval([section '.L;'])*location;
  section = section(1:(end-1));
end
